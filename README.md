# üöÄ –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ6: Production-ready REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏

**–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º**

[![FastAPI](https://img.shields.io/badge/FastAPI-005571?style=for-the-badge&logo=fastapi)](https://fastapi.tiangolo.com)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white)](https://www.postgresql.org)
[![Redis](https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=redis&logoColor=white)](https://redis.io)
[![Docker](https://img.shields.io/badge/Docker-2CA5E0?style=for-the-badge&logo=docker&logoColor=white)](https://www.docker.com)
[![Prometheus](https://img.shields.io/badge/Prometheus-E6522C?style=for-the-badge&logo=Prometheus&logoColor=white)](https://prometheus.io)
[![Grafana](https://img.shields.io/badge/Grafana-F46800?style=for-the-badge&logo=grafana&logoColor=white)](https://grafana.com)

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#-–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
- [‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
- [üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](#Ô∏è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã)
- [üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API](#-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è-api)
- [üìä –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞](#-—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)
- [üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∏-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [üìà –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#-–º–µ—Ç—Ä–∏–∫–∏-–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

### –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ (CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ **–ë–∞–∑–æ–≤—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏** –Ω–∞–¥ –∑–∞–¥–∞—á–∞–º–∏
- ‚úÖ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –¥–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Redis
- ‚úÖ **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** —Å Prometheus –∏ Grafana
- ‚úÖ **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ Docker Compose
- ‚úÖ **Health checks** –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ API

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º async/await
- **Intelligent caching** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- **Connection pooling** –¥–ª—è PostgreSQL –∏ Redis
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã** —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏

### üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **Graceful shutdown** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
- **Health checks** –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **Retry –ª–æ–≥–∏–∫–∞** –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- **Persistent volumes** –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### üìä –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å
- **–î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ** —Å–µ—Ä–≤–∏—Å–æ–≤ Prometheus
- **–ì–æ—Ç–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã** Grafana
- **–≠–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã –º–µ—Ç—Ä–∏–∫** –¥–ª—è PostgreSQL –∏ Redis

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TB
    Client[–ö–ª–∏–µ–Ω—Ç / –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> LB[Load Balancer]
    LB --> FastAPI[FastAPI Application]
    
    FastAPI --> Business[–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞]
    Business --> Cache[(Redis Cache)]
    Business --> DB[(PostgreSQL DB)]
    
    FastAPI --> Metrics[Prometheus Metrics]
    Metrics --> Prometheus[Prometheus Server]
    Prometheus --> Grafana[Grafana Dashboard]
    
    DB --> PGExporter[PostgreSQL Exporter]
    Cache --> RedisExporter[Redis Exporter]
    
    PGExporter --> Prometheus
    RedisExporter --> Prometheus
    
    style FastAPI fill:#009688
    style Cache fill:#d32f2f
    style DB fill:#336791
    style Prometheus fill:#e6522c
    style Grafana fill:#f46800
```
## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker 20.10+
- Docker Compose 2.0+
- 2 –ì–ë —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏
- –ü–æ—Ä—Ç—ã 8000, 9090, 3000 —Å–≤–æ–±–æ–¥–Ω—ã

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd tfss/app

# –°–æ–±–µ—Ä–∏—Ç–µ Docker –æ–±—Ä–∞–∑ —Å —Ç–µ–≥–æ–º test_app
docker build -t test_app .
```
2. **–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ Docker Compose**
```bash
# –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd ..

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d

# –ò–ª–∏ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π –æ–±—Ä–∞–∑–æ–≤
docker-compose up --build -d
```
3. **–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –æ—á–∏—Å—Ç–∫–æ–π –¥–∞–Ω–Ω—ã—Ö
docker-compose down -v

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose restart app

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f --tail=50 app
```
## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger
–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:

```text
http://localhost:8000/docs

```
–í Swagger UI –≤—ã –º–æ–∂–µ—Ç–µ:
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –í–∏–¥–µ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –°–∫–∞—á–∏–≤–∞—Ç—å OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é
## üìä –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
### –î–∞—à–±–æ—Ä–¥—ã Grafana

–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –≥–æ—Ç–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã:

| –ù–∞–∑–≤–∞–Ω–∏–µ | ID –¥–∞—à–±–æ—Ä–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------------|----------|
| Node Exporter Full | 1860 | –ü–æ–ª–Ω—ã–π –æ–±–∑–æ—Ä –º–µ—Ç—Ä–∏–∫ —Å–∏—Å—Ç–µ–º—ã (CPU, –ø–∞–º—è—Ç—å, –¥–∏—Å–∫, —Å–µ—Ç—å) |
| Redis Dashboard | 768 | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Redis (–ø–∞–º—è—Ç—å, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∫–æ–º–∞–Ω–¥—ã, –∫–ª—é—á–∏) |
| PostgreSQL Database | 9628 | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PostgreSQL (–∑–∞–ø—Ä–æ—Å—ã, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏) |
| Prometheus 2.0 Stats | 3662 | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∞–º–æ–≥–æ Prometheus |
–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–º–ø–æ—Ä—Ç—É –¥–∞—à–±–æ—Ä–¥–æ–≤:
–í–æ–π–¥–∏—Ç–µ –≤ Grafana (http://localhost:3000, admin/admin)

–ù–∞–∂–º–∏—Ç–µ "New" ‚Üí "Import"

–í–≤–µ–¥–∏—Ç–µ ID –¥–∞—à–±–æ—Ä–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1860 –¥–ª—è Node Exporter)

–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö Prometheus

–ù–∞–∂–º–∏—Ç–µ "Import"
